<!--pages/shoppingCart/shoppingCart.wxml-->
<wxs src="./../../utils/tools.wxs" module="tools" />
<view class="top-hint" wx:if="{{!closeStore}}"> 
  营业时间：{{order_start_time}} - {{order_end_time}}，其他时间无法下单
</view>
<view class="work-field">
  <view class="hint-black"><text>优惠</text>运费{{tools.returnPrice(activity.amount_delivery)}}元,购物满{{tools.returnPrice(activity.discount_delivery_line)}}元免运费</view>
  <view class="edit-btn" bindtap="changeEdit" wx:if="{{dataItem.length > 0}}">
    <text class="f-r">{{isEdit ? '完成':'编辑'}}</text>
  </view>
</view>

<view class="item-view">
  <view class="item" wx:for="{{dataItem}}" wx:key="index">
    <view class="no-nav {{(item.is_on_sale && tools.judgeItemStock(item) && item.is_quoted) ? '' : 'under_ground' }}">
      <view class="checked" bindtap="redioSelect" data-rs="{{item}}" >
        <image src="{{item.is_select  ? checkedSSrc : checkedSrc}}"></image>
      </view>
      <view class="img">
        <image lazy-load="{{index > 4 ? true : false}}" wx:if="{{item.images.length > 0}}" src="{{tencentPath + item.images[0]}}_watermark200x200"></image>
        <view class="image bg-img-container-item" wx:else></view>
      </view>
      <view class="content">
        <view class="title">{{item.title}}</view>
        <view class="label">
          <text wx:if="{{item.item_spec}}">{{item.item_spec}}</text>
          <text wx:if="{{item.origin_place}}">{{item.origin_place}}</text>
          <text wx:if="{{item.weight_s || item.weight_e}}">{{tools.returnGrossWeight(item)}}</text>
          <text wx:if="{{item.frame_id}}" class="frame">有筐</text>
          <text wx:if="{{item.min_num_per_order}}" class="min-num">{{item.min_num_per_order}}件起售</text>
        </view>
        <view class="join-shop-cart">
          <joinShopCart size="small" sourcePage="shoppingCart" itemData="{{item}}" bindcallback="upDownCallback" isDeleteHint/>
        </view>
      </view>
    </view>
  </view>
  <view class="load-more" wx:if="{{dataItem.length > 0}}">已加载所有</view>
  <defaultPage wx:else currentPage="shoppingCart" loading="{{loading}}"></defaultPage>
</view>

<block wx:if="{{couponNum > 0 && isShowCouponHint}}">
  <view style="height: 89rpx;"></view>
  <view class="coupon-hint" style="bottom: {{dataItem.length > 0 ? 120 : 0}}rpx;">
    <navigator url="/pages/coupon/coupon?from=shoppingCart" class="coupon-item">
      <image src="./../../assets/img/coupon.png" style="width: 40rpx; height: 30rpx;" />
      <view>您有{{couponNum}}张可用优惠券</view>
      <image src="./../../assets/img/right_red.png" style="width: 12rpx; height: 20rpx;" />
    </navigator>
    <view class="close" bind:tap="hideCouponHint">
      <image src="./../../assets/img/close2.png" style="width: 24rpx; height: 24rpx;" />
    </view>
  </view>
</block>

<view style="height: 120rpx;"></view>
<view class="bottom-view b-cfff" wx:if="{{dataItem.length > 0}}">
  <view class="checked" bindtap="allSelect">
    <image src="{{isAllSelect ? checkedSSrc : checkedSrc}}"></image>全选
  </view>
  <view class="total-price" wx:if="{{!isEdit}}">
    <view class="hint">不含运费</view>
    <view class="total-discounts">
      <view class="total">合计:<text class="price"> ￥{{tools.returnPrice(totalPrice)}}</text></view>
      <view class="discounts" wx:if="{{discountsPrice}}">已优惠:<text> ￥{{tools.returnPrice(discountsPrice)}}</text></view>
    </view>
  </view>
  <view class="total-price" wx:else></view>
  <view class="btn" wx:if="{{!isEdit}}">
    <button bindtap="submitClearing" class="btn2" disabled="{{totalNum <= 0 || !closeStore}}">去结算</button>
  </view>
  <view class="btn" wx:else>
    <button bindtap="removeItem" type="warn" >删除</button>
  </view>
</view>
